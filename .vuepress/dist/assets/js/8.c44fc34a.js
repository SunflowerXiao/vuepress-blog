(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{432:function(e,s,t){e.exports=t.p+"assets/img/cookie_lax01.887198fa.png"},433:function(e,s,t){e.exports=t.p+"assets/img/cookir_lax.e099e862.png"},434:function(e,s,t){e.exports=t.p+"assets/img/session.7564d5ef.png"},472:function(e,s,t){"use strict";t.r(s);var o=t(19),i=Object(o.a)({},(function(){var e=this,s=e.$createElement,o=e._self._c||s;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h2",{attrs:{id:"cookie"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#cookie"}},[e._v("#")]),e._v(" "),o("RouterLink",{attrs:{to:"/_posts/HTTP/2022-04-11/cookie.html"}},[e._v("cookie")])],1),e._v(" "),o("h3",{attrs:{id:"特点"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#特点"}},[e._v("#")]),e._v(" 特点")]),e._v(" "),o("ul",[o("li",[e._v("数据大小. 缓存一些数据， 数据量最大为 4kb。 服务器可以通过 "),o("code",[e._v("set-cookie")]),e._v(" 设置 cookie， 浏览器会存储该 cookie， 并且在发送请求的时候回自动带上（设置了 withCredentials=true）")]),e._v(" "),o("li",[e._v("cookie 获取。同源【协议相同，域名相同（同域即 host 相同, 顶级域名, 一级域名, 二级域名, 三级域名等必须相同）, 且域名不能与 ip 对应;， 端口号相同】并且未设置为 http-only 的 cookie 可以在浏览器端获取.")]),e._v(" "),o("li",[o("code",[e._v("security")]),e._v(". 设置了 security=true 的 cookie 只能在 https 请求中传输")]),e._v(" "),o("li",[e._v("个数限制. [不同浏览器有不同的 cookie 个数限制]（https://www.cnblogs.com/henryhappier/archive/2011/03/03/1969564.html）")]),e._v(" "),o("li",[e._v("失效时间. cookie 在失效时间内一直有效，如果未设置失效时间，关闭浏览器就失效")]),e._v(" "),o("li",[e._v("如果 iframe 的 url 与父页面同源，或者 ifram 的 url 为子域（www.abc.com），设置了document.domain = abc.com, 那么该子域可以获取到父域设置的 cookie 值。")])]),e._v(" "),o("h3",{attrs:{id:"cookie-的设置和读取"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#cookie-的设置和读取"}},[e._v("#")]),e._v(" Cookie 的设置和读取")]),e._v(" "),o("div",{staticClass:"language- line-numbers-mode"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v('// 设置cookie\ndocument.cookie ="username1=randy1;expires=Thu, 18 Dec 2043 12:00:00 GMT; path=/\n// 读取cookie\ndocument.cookie\n')])]),e._v(" "),o("div",{staticClass:"line-numbers-wrapper"},[o("span",{staticClass:"line-number"},[e._v("1")]),o("br"),o("span",{staticClass:"line-number"},[e._v("2")]),o("br"),o("span",{staticClass:"line-number"},[e._v("3")]),o("br"),o("span",{staticClass:"line-number"},[e._v("4")]),o("br")])]),o("h3",{attrs:{id:"cookie-的属性"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#cookie-的属性"}},[e._v("#")]),e._v(" Cookie 的属性")]),e._v(" "),o("ul",[o("li",[o("p",[e._v("key = value, 设置 cookie 的属性名和属性值")])]),e._v(" "),o("li",[o("p",[e._v("expires, 设置过期时间，该时间内 cookie 一直有效")])]),e._v(" "),o("li",[o("p",[e._v("max-age， 设置 cookie 的失效时间，单位为秒。如果值为负数，则浏览器关闭后就失效。 0 表示删除该 cookie. 默认是-1")])]),e._v(" "),o("li",[o("p",[e._v("path 指定 cookie 在哪个路径下生效，默认是 '/'")])]),e._v(" "),o("li",[o("p",[e._v("demaim 指定 cookie 在哪个域名下生效，默认是 当前域名")])]),e._v(" "),o("li",[o("p",[e._v("secure 是否在 https 下面生效")])]),e._v(" "),o("li",[o("p",[e._v("httpOnly 设置该值，则 js 读取不到这个 cookie 的值")])]),e._v(" "),o("li",[o("p",[e._v("SameSite "),o("code",[e._v("strict")]),e._v(", "),o("code",[e._v("Lax")]),e._v(", "),o("code",[e._v("None")]),e._v(". 默认值为 "),o("code",[e._v("Lax")]),e._v("。 设置为 strict 可以避免 CSRF 攻击。")]),e._v(" "),o("ul",[o("li",[o("p",[e._v("Lax：大多数情况也是不发送第三方 Cookie，但是导航到目标网址的 Get 请求除外( top-level navigations)。"),o("br"),e._v("\n导航到目标网址的 Get 请求只包括三种情况：链接，预加载请求\n"),o("img",{attrs:{src:t(432),alt:"导航到目标网址的 Get 请求"}})]),e._v(" "),o("p",[o("img",{attrs:{src:t(433),alt:"导航到目标网址的 Get 请求"}})])]),e._v(" "),o("li",[o("p",[e._v("strict: 完全禁止第三方 Cookie")])]),e._v(" "),o("li",[o("p",[e._v("None: 当 "),o("code",[e._v("Secure")]),e._v(" 设置为 "),o("code",[e._v("true")]),e._v(", 并且设置了 "),o("code",[e._v("withCredentials=true")]),e._v(" 的请求都可以携带第三方 cookie")])])])])]),e._v(" "),o("h2",{attrs:{id:"session"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#session"}},[e._v("#")]),e._v(" session")]),e._v(" "),o("ul",[o("li",[e._v("代表服务器和客户端之间的一次会话流程。")]),e._v(" "),o("li",[e._v("浏览器或者 Tab 页关闭，session 就失效")])]),e._v(" "),o("h3",{attrs:{id:"session-cookie-的认证流程"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#session-cookie-的认证流程"}},[e._v("#")]),e._v(" session + cookie 的认证流程")]),e._v(" "),o("p",[o("img",{attrs:{src:t(434),alt:"session+cookie认证流程"}})]),e._v(" "),o("p",[o("RouterLink",{attrs:{to:"/_posts/HTTP/2022-04-11/login.html"}},[e._v("其他的认证流程")])],1),e._v(" "),o("h3",{attrs:{id:"session-cookie-的存在的问题"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#session-cookie-的存在的问题"}},[e._v("#")]),e._v(" session + cookie 的存在的问题")]),e._v(" "),o("p",[e._v("每个不同客户端去访问服务器都需要生成一个 session_id，存储在服务器端。这样会增大服务器端的压力和维护成本")]),e._v(" "),o("ul",[o("li",[e._v("分布式 session，可以将 session 统一集中存储。")])]),e._v(" "),o("h2",{attrs:{id:"localstorage"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#localstorage"}},[e._v("#")]),e._v(" localstorage")]),e._v(" "),o("ul",[o("li",[e._v("同源窗口共享")]),e._v(" "),o("li",[e._v("长久保存网站数据，只能手动清除")]),e._v(" "),o("li",[e._v("可以监听 storage 事件")]),e._v(" "),o("li",[e._v("存放 5M 的数据")])]),e._v(" "),o("h2",{attrs:{id:"sessionstorage"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#sessionstorage"}},[e._v("#")]),e._v(" sessionStorage")]),e._v(" "),o("ul",[o("li",[e._v("同源窗口共享")]),e._v(" "),o("li",[e._v("临时保存网站数据，关闭标签页或者窗口就会失效")]),e._v(" "),o("li",[e._v("可以监听 storage 事件")]),e._v(" "),o("li",[e._v("存放 5M 的数据")])]),e._v(" "),o("h2",{attrs:{id:"indexdb"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#indexdb"}},[e._v("#")]),e._v(" indexDB")]),e._v(" "),o("h2",{attrs:{id:"application-cache"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#application-cache"}},[e._v("#")]),e._v(" Application Cache")]),e._v(" "),o("h2",{attrs:{id:"pwa-progressive-web-apps"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#pwa-progressive-web-apps"}},[e._v("#")]),e._v(" "),o("RouterLink",{attrs:{to:"/_posts/HTTP/2022-04-11/pwa.html"}},[e._v("PWA(Progressive Web Apps)")])],1)])}),[],!1,null,null,null);s.default=i.exports}}]);