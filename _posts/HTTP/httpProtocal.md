---
title: http协议
tags:
  - http
  - s20220413
location: fish
summary: 客户端(如Web浏览器)从服务器(如Web服务器)请求资源时用到的协议。明文传输，可能会导致中间人攻击
date: 2022-04-13
---

- http 协议是超文本传输协议。
- 请求是无状态的。 协议对事务没有记忆能力， 如果后续处理需要之前的一些状态信息，就必须要重传。所以需要通过 cookie 和 session_id 来保存这个状态信息。
- 基于 TCP/IP 通信协议传递数据

## Http1.0

- 短连接
- 数据明文传输
- 头部协议不能压缩

## Http1.1

### 文本传输

http1.1 的请求响应头和请求头信息都是明文的，并且是文本形式的

[响应头信息](./header.md)
[消息头信息](./header.md)

### 队头阻塞/ 并发请求

- 一个 TCP 连接一次只能发送一个请求，浏览器一次最多允许并行发送 6-8 个的 TCP 连接请求 （同一个域名下）
- 如果在一个 TCP 连接上的请求处理时间过长，就会造成队头阻塞

## Http2.0

建立一次 TCP/TP 连接，可以一次发送多个请求，请求内容以二进制的格式进行传输， 可能会产生丢包的现象

### 二进制传输

frame 帧

http2 中，同个域名下的所有通信都在单个连接上面完成，连接承载双向数据流。  
数据流以消息的形式发送， 消息由一个或者多个帧组成，可能会被乱序发送。根据帧首部的标识可以重新组装

### 多路复用

不同于 http1.1 的并发请求控制， http2.0 同一个域名下面只需要发送一个 TCP 连接， 该连接可以同时发送多个 http 请求。  
请求可以设置发送 的优先级

### 压缩 headers， 存储 header

HTTP/2 对消息头采用`HPACK`(专为 http/2 头部设计的压缩格式)进行压缩传输，能够节省消息头占用的网络的流量。

### 首部表

- HTTP/2 在客户端和服务器端使用“首部表”来跟踪和存储之前发送的键－值对，对于相同的头部数据，不再通过每次请求和响应发送；
- 首部表在 HTTP/2 的连接存续期内始终存在，由客户端和服务器共同渐进地更新;
- 每个新的首部键－值对要么被追加到当前表的末尾，要么替换表中之前的值。

### 服务端推送

服务器可以在发送资源的时候，主动推送其他资源。而不用等到浏览器解析到对应位置主动再去发送一次请求  
浏览器可以选择使用服务器主动推送的资源还是从缓存中读取资源

## Http3.0

### 基于 UDP 的传输
